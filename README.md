# MP3 AutoCut — CLI-утилита для нарезки MP3

MP3 AutoCut — это программа, которая автоматически делит длинные MP3-файлы (например, аудиокниги, лекции, подкасты, диктофонные записи) на короткие удобные части. Она ищет естественные паузы (тишину) и режет аудио так, чтобы не обрывать фразы. Можно менять скорость воспроизведения, а готовые файлы легко скопировать на внешний диск — при этом сохраняется правильный порядок для прослушивания на наушниках Shokz. Особенно полезно для Shokz, где нельзя перематывать на 30-60 секунд: просто нарежь аудио на короткие файлы и переключайся между ними двойным или тройным нажатием на Shokz.

## Возможности

- Рекурсивный поиск и обработка всех MP3 в папке
- Нарезка по тишине с гибкими параметрами
- Изменение скорости воспроизведения (0.5–2.0, экспериментально до 10)
- Копирование и перемещение файлов с проверкой целостности (SHA256)
- CLI-интерфейс с подробными логами

## Требования

- Python 3.6+
- ffmpeg (должен быть в PATH)
- Зависимости из requirements.txt

## Установка

1. Установи Python 3.6+
2. Установи ffmpeg:
   - macOS: `brew install ffmpeg`
   - Ubuntu/Debian: `sudo apt install ffmpeg`
   - Windows: [официальный сайт](https://ffmpeg.org/download.html), добавить в PATH
3. Установи зависимости:
   ```
   pip install -r requirements.txt
   ```

## Важно про версию Python

Для macOS и новых Linux: используй **python3.12** (или активируй venv, см. ниже), иначе будет ошибка audioop/pydub!

## Использование

### Базовая обработка всех MP3 из папки `source_mp3` в `ready_mp3`:
```
python split_mp3.py
```

### Кастомные параметры:
```
python split_mp3.py -i my_mp3s -o out_mp3s -d 300 -w 8 -t -35 -m 700 -s 1.25
```

### Только копирование и перемещение (без обработки):
```
python split_mp3.py --copy-only --output-dir ready_mp3 --copy-to /Volumes/DRIVE
```

### Все параметры:
- `-i, --input-dir` — папка с исходными MP3 (по умолчанию: source_mp3)
- `-o, --output-dir` — папка для результатов (по умолчанию: ready_mp3)
- `-d, --duration` — желаемая длительность куска, сек (по умолчанию: 180)
- `-w, --window` — окно поиска тишины, сек (по умолчанию: 10)
- `-t, --threshold` — порог тишины, dBFS (по умолчанию: -40)
- `-m, --min-silence` — мин. длина тишины, мс (по умолчанию: 500)
- `-s, --speed` — коэффициент скорости (по умолчанию: 1.0)
- `--skip-existing` — пропускать файлы, если уже есть результат
- `--copy-only` — только копировать и перемещать, не обрабатывать
- `--copy-to` — путь для копирования (требуется для --copy-only)

### Примеры команд

```
python3.12 split_mp3.py
```
Обычная нарезка: всё по дефолту (source_mp3 → ready_mp3, 180 сек, скорость 1.0)

```
python3.12 split_mp3.py -i audiobooks -o output -d 120 -w 10 -t -35 -m 1000
```
Нарезать все mp3 из папки audiobooks на куски по 2 минуты, искать паузы длиной от 1000 мс (1 сек) с порогом -35 dBFS в окне 10 сек, результат в папке output.

```
python3.12 split_mp3.py -s 1.5
```
Ускорить все mp3 в 1.5 раза.

```
python3.12 split_mp3.py --skip-existing
```
Пропускать файлы, если уже есть результат.

```
python3.12 split_mp3.py --copy-only --output-dir ready_mp3 --copy-to /Volumes/USB
```
Только скопировать все mp3 из папки ready_mp3 на внешний диск /Volumes/USB с проверкой целостности файлов (SHA256), затем переместить их в папку copied_mp3.

```
python3.12 split_mp3.py -i lectures -o chunks -d 120 -w 5 -t -45 -m 300 -s 0.8
```
Нарезать все mp3 из папки lectures на куски по 2 минуты, искать паузы длиной от 300 мс с порогом -45 dBFS в окне 5 сек, замедлить аудио до 0.8x, результат в папке chunks.

---

**Альтернатива:**
Если не хочешь писать python3.12 каждый раз, активируй venv:
```
source venv312/bin/activate
python split_mp3.py ...
```

## Пример типового сценария
1. Сложи исходные MP3 в папку `source_mp3`
2. Запусти обработку:
   ```
   python split_mp3.py
   ```
3. Готовые куски будут в `ready_mp3` (структура папок сохраняется)
4. Для копирования на внешний диск:
   ```
   python split_mp3.py --copy-only --output-dir ready_mp3 --copy-to /Volumes/DRIVE
   ```

## Примечания
- Для корректной работы требуется ffmpeg
- Все параметры CLI смотри через `python split_mp3.py -h`
- Вся логика теперь только в split_mp3.py
